<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Schedule Match</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <nav class="navbar navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand">üìÖ Schedule Match</a>
      <a href="dashboard.html" class="text-white">‚Üê Back</a>
    </div>
  </nav>

  <div class="container py-4">
    <h2>Schedule New Match</h2>
    <form id="matchForm">
      <div class="mb-3">
        <label>Event</label>
        <select class="form-select" id="eventSelect" required></select>
      </div>
      <div class="mb-3">
        <label>Sport Type</label>
        <input type="text" class="form-control" id="sportType" required />
      </div>
      <div class="mb-3">
        <label>Team A</label>
        <input type="text" class="form-control" id="teamA" required />
      </div>
      <div class="mb-3">
        <label>Team B</label>
        <input type="text" class="form-control" id="teamB" required />
      </div>
      <div class="mb-3">
        <label>Date & Time</label>
        <input type="datetime-local" class="form-control" id="scheduledTime" required />
      </div>
      <div class="mb-3">
        <label>Venue</label>
        <input type="text" class="form-control" id="venue" required />
      </div>
      <div class="mb-3">
        <label>Round</label>
        <input type="text" class="form-control" id="round" value="Group Stage" />
      </div>
      <button type="submit" class="btn btn-success">Schedule Match</button>
    </form>
  </div>

  <script>
    window.onload = () => {
      fetch('http://127.0.0.1:8000/api/events')
        .then(r => r.json())
        .then(events => {
          const sel = document.getElementById('eventSelect');
          events.forEach(e => {
            const opt = document.createElement('option');
            opt.value = e._id.$oid;
            opt.textContent = e.event_name;
            sel.appendChild(opt);
          });
        });
    };

    document.getElementById('matchForm').onsubmit = async (e) => {
      e.preventDefault();
      const f = e.target;

      const data = {
        event_id: f.eventSelect.value,
        sport_type: f.sportType.value,
        team_a: f.teamA.value,
        team_b: f.teamB.value,
        scheduled_time: f.scheduledTime.value,
        venue: f.venue.value,
        round: f.round.value
      };

      const res = await fetch('http://127.0.0.1:8000/api/schedule-match', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      if (res.ok) {
        alert("‚úÖ Match scheduled!");
        f.reset();
      } else {
        alert("‚ùå Failed to schedule match.");
      }
    };
  </script>
</body>
</html>